var x=Object.defineProperty;var B=a=>{throw TypeError(a)};var q=(a,e,t)=>e in a?x(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var k=(a,e,t)=>q(a,typeof e!="symbol"?e+"":e,t);var p=(a,e,t)=>e.has(a)?B("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t);var y,w,v;class h{constructor(e={}){p(this,y,null);p(this,w,null);p(this,v,null);_.extend(this,e),this.currentViews=new Array,this.el=e.el}show(e){this.closeView(this.currentView),this.currentView=e,this.openView(e)}html(e){this.$el&&this.$el.html(e)}append(e){this.currentViews.push(e),this.ensureEl(),e.render(),this.$el.append(e.el),e.onShow&&e.onShow()}closeView(e){e&&e.remove&&e.remove()}openView(e){this.ensureEl(),e.render(),this.$el.html(e.el),e.onShow&&e.onShow()}ensureEl(){this.$el||(this.$el=$(this.el))}remove(){this.currentViews.length>0&&this.currentViews.forEach(e=>{this.closeView(e)}),this.closeView(this.currentView)}}y=new WeakMap,w=new WeakMap,v=new WeakMap;const d=(()=>{let a,e,t,i;return{hide:(o=!1)=>{o&&e.remove(),a&&t.remove(),a=void 0},show:(o=!1,s)=>{o&&(e=document.createElement("div"),e.setAttribute("id","loading_msj"),$(e).html("<div class='loading_msj'><p class='text-warning'>Procesando datos de busqueda...</p></div>"),document.getElementById("app").appendChild(e)),a||(i=_.template($("#tmp_loader").html()),t=document.createElement("div"),t.setAttribute("class","loader"),t.setAttribute("id","loader"),$(t).append(i()),document.body.appendChild(t),t.setAttribute("style","display:block"),_.isObject(s)===!0&&s.addClass&&$(".loader").addClass(s.addClass)),a=!0}}})(),C=$("[name='csrf-token']"),f={path:C.attr("path"),app:C.attr("app")};class m{static getKumbiaURL(e){return typeof e>"u"&&(e=""),f.path+e}static getAppURL(e){return typeof e>"u"&&(e=""),f.path+e}static getURL(e){return typeof e>"u"?f.path:f.path+e}static redirectParentToAction(e){new m.redirectToAction(e,window.parent)}static redirectOpenerToAction(e){new m.redirectToAction(e,window.opener)}static redirectToAction(e,t){t=t||window,t.location.href=m.getKumbiaURL()+e}static upperCaseFirst(e){return e.substring(0,1).toUpperCase()+e.substr(1,e.length-1)}static numberFormat(e=0,t=0,i=void 0,n=void 0){let r=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,s=typeof n>"u"?",":n,g=typeof i>"u"?".":i,u;return u=(o?((S,j)=>{let R=Math.pow(10,j);return""+Math.round(S*R)/R})(r,o):""+Math.round(r)).split("."),u[0].length>3&&(u[0]=u[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(u[1]||"").length<o&&(u[1]=u[1]||"",u[1]+=new Array(o-u[1].length+1).join("0")),u.join(g)}static validOnlyLetter(e){e=e||(window.event?window.event:null);let t=e.keyCode;(t>=65&&t<=90||t==8||t==9||t==32)==!1&&(e.preventDefault(),e.stopPropagation(),e.stopped=!0)}}let c=class{static display(e,t,i=8e3){new Noty({text:e,layout:"topRight",theme:"relax",type:t,timeout:i}).show()}};const l={Models:{},Collections:{},router:null,currentSubapp:null,Modal:null,layout:null,el:null,mainRegion:null,startApp(a,e="",t=""){this.el=t,this.el===""&&(this.el="#contentView"),this.initialize(),this.router=new a,Backbone.history.start()||this.router.navigate(e,{trigger:!0})},initialize(){_.extend(this,Backbone.Events),["error","warning","success","info"].forEach(e=>{this.listenTo(this,`noty:${e}`,t=>this.notify(e,t)),this.listenTo(this,`alert:${e}`,t=>this.alert(e,t))}),this.listenTo(this,"confirma",this.confirmaApp),this.listenTo(this,"syncro",this.syncroRequest),this.listenTo(this,"ajax",this.ajaxKumbia),this.listenTo(this,"show:modal",this.renderModal),this.listenTo(this,"hide:modal",this.closeModal),this.listenTo(this,"down",this.downLoadFile),this.listenTo(this,"upload",this.uploadFile)},notify(a,e){this.showNoty(a,e.toString(),a==="error"?1e4:6e3)},alert(a,e){const{title:t="Notificación",message:i="Nota no hay respuesta de la solicitud",timer:n=8200}=e;this.showAlert(t,i,a,n)},showNoty(a,e,t){new Noty({text:e,layout:"topRight",theme:"relax",type:a,timeout:t}).show()},showAlert(a="",e="",t="",i){Swal.fire({title:a,html:e,icon:t,showConfirmButton:!1,confirmButtonText:"Continuar",timer:i})},startSubApplication(a,e,t={}){let i=[];return typeof e!="string"&&(_.isArray(e)===!0?_.each(e,n=>{i[n.name]=new n.inyectar}):_.isObject(e)===!0?i[e.name]=new e.inyectar:i.push(e)),this.mainRegion=new h({el:this.el,...t}),this.currentSubapp=new a({region:this.mainRegion,services:i,App:this}),this.currentSubapp},confirmaApp(a){const{message:e,callback:t,title:i="¿Confirmar?",icon:n="warning"}=a;Swal.fire({title:i,text:e,icon:n,showCancelButton:!0,confirmButtonColor:"#2dce89",cancelButtonColor:"#fc8c72",confirmButtonText:"SI, Continuar!"}).then(r=>{t(r.isConfirmed)})},syncroRequest(a){const{url:e,data:t={},callback:i,silent:n=!1}=a,r=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({type:"POST",dataType:"json",url:e,data:t,cache:!1,contentType:"application/x-www-form-urlencoded",processData:!0,timeout:52400,beforeSend:o=>{n==!1&&d.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.length>0&&o.setRequestHeader("Authorization","Bearer "+r)},success:o=>(n==!1&&d.hide(),i(o)),error:o=>{const s=_.keys(o);return n==!1&&d.hide(),_.indexOf(s,"responseText")!==-1?(console.log(o.responseText),this.trigger("alert:error",{message:o.responseText})):(console.log(o),this.trigger("alert:error",{message:o})),i(!1)}})},renderModal(a={}){const{title:e,view:t,options:i=!1}=a,n=$("#modalComponent");this.Modal||(this.Modal=new bootstrap.Modal(document.getElementById("modalComponent"),{keyboard:!0,backdrop:"static"})),n.find("#mdl_set_title").text(e),n.find("#mdl_set_footer").css("display","none"),i&&n.find(".modal-dialog").addClass(i.bootstrapSize),n.find("#mdl_set_body").html(t.render().$el),this.Modal.show(),i&&(this.Modal.on("hidden.bs.modal",r=>t.remove()),n.find(".close").addClass("d-none"))},closeModal(a){this.Modal&&(this.Modal.hide(),this.Modal=null),a&&a.remove()},url(a="",e=void 0){return this.kumbiaURL((e??"")+"/"+a)},kumbiaURL:a=>(_.isUndefined(a)===!0&&(a=""),f.path+a),ajaxKumbia(a={}){const{url:e,data:t={},callback:i,silent:n=!1}=a,r=document.querySelector("[name='csrf-token']").getAttribute("content");$.ajax({type:"POST",data:t,url:this.kumbiaURL(e),dataType:"html",processData:!0,contentType:"application/x-www-form-urlencoded",cache:!1,beforeSend:o=>{n==!1&&d.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.length>0&&o.setRequestHeader("Authorization","Bearer "+r)}}).done(o=>(n==!1&&d.hide(),i(o))).fail(o=>(n==!1&&d.hide(),this.trigger("alert:error",{message:o.responseText}),i(!1))).always(()=>{n==!1&&d.hide()})},downLoadFile(a){const{url:e,filename:t}=a,i=document.createElement("a");i.href=this.kumbiaURL(e+"/"+t),i.download=t,console.log(i),i.click()},uploadFile(a){const{url:e,data:t,callback:i,silent:n=!1}=a;let r;t instanceof FormData?r=t:(r=new FormData,r.append(t.name,t.file));const o=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({url:e,type:"POST",dataType:"json",data:r,cache:!1,contentType:!1,processData:!1,beforeSend:s=>{n==!1&&d.show(),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.length>0&&s.setRequestHeader("Authorization","Bearer "+o)},success:s=>(n==!1&&d.hide(),i(s)),error:s=>{const g=_.keys(s);return console.log(s),n==!1&&d.hide(),_.indexOf(g,"responseText")!==-1?this.trigger("alert:error",{message:s.responseText}):this.trigger("alert:error",{message:s}),i(!1)}})}},M=a=>{$("#form").validate({rules:{estado:{required:!0}}}),$("#form").valid()&&$.ajax({type:"POST",url:l.url("consulta_trabajadores"),data:{estado:$("#estado").val()}}).done(function(e){e.flag==!1?c.display(e.msg,"error"):$("#consulta").html(e.data)}).fail(function(e,t){c.display("Request failed: "+t,"error")})},A=a=>{$("#form").validate({rules:{periodo:{required:!0,date:!1}}}),$("#form").valid()&&$.ajax({type:"POST",url:l.url("consulta_nomina"),data:{periodo:$("#periodo").val()}}).done(function(e){!e||e.success==!1?c.display(e.msg,"error"):($("#consulta").html(e.data),$('[data-toggle="tooltip"]').tooltip())}).fail(function(e,t){alert("Request failed: "+t)})},O=a=>{$("#form").validate({rules:{perini:{required:!0},perfin:{required:!0,greaterThan:["#perini","Periodo Inicial"]}}}),$("#form").valid()&&$.ajax({type:"POST",url:l.url("consulta_aportes"),data:{perini:$("#perini").val(),perfin:$("#perfin").val()}}).done(function(e){const t=$.parseJSON(e);t.flag==!1?c.display(t.msg,"error"):$("#consulta").html(t.data)}).fail(function(e,t){alert("Request failed: "+t)})},E=()=>{$("#form").validate({rules:{cedtra:{required:!0},nombre:{required:!0},codest:{required:!0},fecret:{required:!0},archivo:{required:!0},nota:{required:!0}}}),$("#form").valid()&&$("#archivo").upload(l.url("novedad_retiro"),{cedtra:$("#cedtra").val(),nombre:$("#nombre").val(),codest:$("#codest").val(),fecafi:$("#fecafi").val(),fecret:$("#fecret").val(),nota:$("#nota").val()},function(a){const e=$.parseJSON(a);e.flag==!0?(c.display(e.msg,"success"),window.location.reload()):c.display(e.msg,"error")})},b=()=>{$("#form").validate({rules:{tipo:{required:!0}}}),$("#form").valid()&&$("#form").submit()},P=()=>{if($("#archivo").val()==""){c.display("Adjunte algun Archivo","error");return}$("#archivo").upload(l.url("afilia_masiva_trabajador"),{},function(a){a.flag==!0?c.display(a.msg,"success"):c.display(a.msg,"error"),$("#consulta").html(a.data)})},H=()=>{Swal.fire({title:"Esta seguro de actualizar los datos?",text:"",type:"warning",showCancelButton:!0,confirmButtonClass:"btn btn-success btn-fill",cancelButtonClass:"btn btn-danger btn-fill",confirmButtonText:"SI",cancelButtonText:"NO"}).then(a=>{a.value&&$("#form").submit()})},N=()=>{window.location.href=l.url("ejemplo_planilla_masiva")},D=()=>{window.location.href=l.url("ejemplo_planilla_activacion_masiva")},L=()=>{if($("#archivo").val()==""){c.display("Adjunte algun Archivo","error");return}$("#archivo").upload(l.url("activacion_masiva_trabajador"),{},function(a){a.flag==!0?(c.display(a.msg,"success"),window.open(m.getURL(a.file),"_blank"),console.log("el poderoso")):c.display(a.msg,"error"),$("#consulta").html(a.data)})},V=()=>{if($("#form").validate({rules:{email:{required:!0,email:!0}}}),!$("#form").valid())return!1;Swal.fire({text:"Esta seguro de actualizar el email de aviso?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn btn-success btn-fill",cancelButtonClass:"btn btn-danger btn-fill",confirmButtonText:"SI",cancelButtonText:"NO"}).then(a=>{a.isConfirmed&&$.ajax({type:"POST",url:l.url("cambio_email"),data:{email:$("#email").val()}}).done(function(e){const t=$.parseJSON(e);t.flag==!1?c.display(t.msg,"error"):c.display(t.msg,"success")}).fail(function(e,t){alert("Request failed: "+t)})})},F=()=>{if($("#form").validate({rules:{claant:{required:!0},clave:{required:!0},clacon:{required:!0}}}),!$("#form").valid())return!1;Swal.fire({text:"Esta seguro de cambiar la clave de acceso?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn btn-success btn-fill",cancelButtonClass:"btn btn-danger btn-fill",confirmButtonText:"SI",cancelButtonText:"NO"}).then(a=>{a.isConfirmed&&$.ajax({type:"POST",url:l.url("cambio_clave"),data:{claant:$("#claant").val(),clave:$("#clave").val(),clacon:$("#clacon").val()}}).done(function(e){const t=$.parseJSON(e);t.flag==!1?c.display(t.msg,"error"):c.display(t.msg,"success")}).fail(function(e,t){alert("Request failed: "+t)})})};class T extends Backbone.View{constructor(t={modelDOM:null,onRender:null}){super(t);k(this,"modelDOM",null);this.modelDOM=t.modelDOM||Backbone.Model,this.template=null,_.extend(this,t),this.onRender=_.isFunction(this.onRender)?this.onRender:null}render(){const t=this.serializeData();let i;return _.isFunction(this.template)?i=this.template(t):_.isString(this.template)&&(i=this.compileTemplate()(t)),this.$el.html(i),this.onRender&&this.onRender(this.$el),this}compileTemplate(){if(_.isString(this.template)===!0){const t=document.querySelector(this.template);return _.template(t.innerHTML)}return!1}serializeData(){let t=null;return this.modelDOM!==null?this.model instanceof this.modelDOM?t=this.model.toJSON():typeof this.model=="object"&&(t=this.model):typeof this.model=="object"&&(t=this.model),t||{}}getInput(t){return this.$el.find(`[name='${t}']`).val()}getInputById(t){return this.$el.find("#"+t).val()}setInput(t,i){return this.$el.find(`[name='${t}']`).val(i??"")}getInputByTag(t,i){return this.$el.find(`[${t}='${i}']`).val()}getCheck(t){return this.$el.find(`[name='${t}']:checked`).length}getInputFile(t){return this.$el.find("#"+t).files[0]}}class I extends T{constructor(e={}){super({...e,className:"row",onRender:()=>this.afterRender()}),this.$App=l,this.template=_.template(document.getElementById("templateConyuge").innerHTML)}afterRender(){console.log("afterRender")}}class X extends T{constructor(e={}){super({...e,className:"row",onRender:()=>this.afterRender()}),this.$App=l,this.template=_.template(document.getElementById("templateBeneficiario").innerHTML)}afterRender(){console.log("afterRender")}}const z=()=>"Url error is undefined!",U=()=>Backbone.emulateHTTP=!0,J={create:"POST",update:"PUT",fetch:"GET",destroy:"DELETE"};Backbone.sync=(a,e,t)=>{const i=J[a],n=_.extend({type:i,dataType:"json",processData:!1},t);return n.url||(n.url=e.url||z()),!n.data&&e&&(a=="create"||a=="update")&&(n.contentType="application/json",n.data=JSON.stringify(e.toJSON())),!Backbone.emulateJSON&&!Backbone.emulateHTTP&&U(),Backbone.emulateJSON&&(n.contentType="application/x-www-form-urlencoded",n.processData=!0,n.data=n.data?{model:n.data}:{},n.beforeSend=function(r){r.setRequestHeader("X-Requested-With","XMLHttpRequest")}),Backbone.emulateHTTP&&(i==="PUT"||i==="DELETE")&&(Backbone.emulateJSON&&(n.data._method=i),n.type="POST",n.beforeSend=r=>{r.setRequestHeader("X-HTTP-Method-Override",i)}),$.ajax(n)};const K={processing:"Procesando...",lengthMenu:"Mostrar _MENU_ resultados por pagínas",zeroRecords:"No se encontraron resultados",info:"Mostrando pagína _PAGE_ de _PAGES_.	Total de _TOTAL_ registros.",infoEmpty:"No records available",infoFiltered:"(filtered from _MAX_ total records)",emptyTable:"Ningún dato disponible en esta tabla",search:"Buscar",paginate:{next:"siguiente",previus:"anterior",first:"primero",last:"ultimo"},loadingRecords:"Cargando...",buttons:{copy:"Copiar",colvis:"Visibilidad",collection:"Colección",colvisRestore:"Restaurar visibilidad",copyKeys:"Presione ctrl o u2318 + C para copiar los datos de la tabla al portapapeles del sistema. <br /> <br /> Para cancelar, haga clic en este mensaje o presione escape.",copySuccess:{1:"Copiada 1 fila al portapapeles",_:"Copiadas %d fila al portapapeles"}}};class G extends T{constructor(e={}){super({...e,onRender:()=>this.afterRender()}),this.template=_.template(document.getElementById("templateConsulta").innerHTML)}afterRender(){this.model.cuotas.length!=0&&(this.tableView=this.$el.find("#dataTable").DataTable({paging:!0,ordering:!0,pageLength:10,info:!0,searching:!0,pagingType:"numbers",language:K}))}}function W(){$.ajax({type:"POST",url:l.url("consulta_giro"),data:{perini:$("#perini").val(),perfin:$("#perfin").val()},beforeSend:function(){d.show()}}).done(function(a){if(d.hide(),a.success==!1)l.alert("error",{title:"Error",message:a.msj,timer:8200});else{const e=new G({model:{cuotas:a.data}});new h({el:"#consulta"}).show(e)}}).fail(function(a,e){l.alert("error",{title:"Error",message:e.error,timer:8200})})}$(()=>{l.initialize(),$(document).on("click","#bt_consulta_giro",function(a){a.preventDefault(),$("#form").validate({rules:{perini:{required:!0,date:!1},perfin:{required:!0,date:!1}}}).valid()&&W()}),$(document).on("click","#btn_consulta_nomina",A),$(document).on("click","#bt_consulta_aportes",O),$(document).on("click","#bt_certificado_afiliacion",b),$(document).on("click","#bt_certificado_afiliacion",b),$(document).on("click","#bt_activacion_masiva_trabajador",L),$(document).on("click","#bt_actualiza_datos_basicos",H),$(document).on("click","#bt_ejemplo_planilla_activacion_masiva",D),$(document).on("click","#bt_ejemplo_planilla_masiva",N),$(document).on("click","#bt_afilia_masiva_trabajador",P),$(document).on("click","#bt_certificado_afiliacion",b),$(document).on("click","#bt_novedad_retiro",E),$(document).on("click","#bt_cambio_email",V),$(document).on("click","#bt_cambio_clave",F),$(document).on("click","#bt_consulta_trabajadores",M),$(document).on("click",'[data-event="ver_nucleo_familiar"]',function(a){a.preventDefault();const e=$(a.currentTarget).data("cedtra");e&&$.ajax({type:"POST",url:l.url("consulta_nucleo"),data:{cedtra:e}}).done(function(t){if(t.success==!1)Messages.display(t.msj,"error");else{const i=new bootstrap.Modal(document.getElementById("modalConsultaNucleo"),{keyboard:!0,backdrop:"static"}),n=new I({model:{...t.data.params,conyuges:t.data.conyuges}});new h({el:"#render_conyuges"}).show(n);const o=new X({model:{...t.data.params,beneficiarios:t.data.beneficiarios}});new h({el:"#render_beneficiarios"}).show(o),i.show()}}).fail(function(t,i){Messages.display(i.error,"error")})})});
//# sourceMappingURL=ConsultasEmpresa.js.map
