var C=t=>{throw TypeError(t)};var p=(t,e,i)=>e.has(t)?C("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i);var g,b,y;class R{constructor(e={}){p(this,g,null);p(this,b,null);p(this,y,null);_.extend(this,e),this.currentViews=new Array,this.el=e.el}show(e){this.closeView(this.currentView),this.currentView=e,this.openView(e)}html(e){this.$el&&this.$el.html(e)}append(e){this.currentViews.push(e),this.ensureEl(),e.render(),this.$el.append(e.el),e.onShow&&e.onShow()}closeView(e){e&&e.remove&&e.remove()}openView(e){this.ensureEl(),e.render(),this.$el.html(e.el),e.onShow&&e.onShow()}ensureEl(){this.$el||(this.$el=$(this.el))}remove(){this.currentViews.length>0&&this.currentViews.forEach(e=>{this.closeView(e)}),this.closeView(this.currentView)}}g=new WeakMap,b=new WeakMap,y=new WeakMap;const r=(()=>{let t,e,i,s;return{hide:(n=!1)=>{n&&e.remove(),t&&i.remove(),t=void 0},show:(n=!1,o)=>{n&&(e=document.createElement("div"),e.setAttribute("id","loading_msj"),$(e).html("<div class='loading_msj'><p class='text-warning'>Procesando datos de busqueda...</p></div>"),document.getElementById("app").appendChild(e)),t||(s=_.template($("#tmp_loader").html()),i=document.createElement("div"),i.setAttribute("class","loader"),i.setAttribute("id","loader"),$(i).append(s()),document.body.appendChild(i),i.setAttribute("style","display:block"),_.isObject(o)===!0&&o.addClass&&$(".loader").addClass(o.addClass)),t=!0}}})(),T=$("[name='csrf-token']"),S={path:T.attr("path"),app:T.attr("app")},f={Models:{},Collections:{},router:null,currentSubapp:null,Modal:null,layout:null,el:null,mainRegion:null,startApp(t,e="",i=""){this.el=i,this.el===""&&(this.el="#contentView"),this.initialize(),this.router=new t,Backbone.history.start()||this.router.navigate(e,{trigger:!0})},initialize(){_.extend(this,Backbone.Events),["error","warning","success","info"].forEach(e=>{this.listenTo(this,`noty:${e}`,i=>this.notify(e,i)),this.listenTo(this,`alert:${e}`,i=>this.alert(e,i))}),this.listenTo(this,"confirma",this.confirmaApp),this.listenTo(this,"syncro",this.syncroRequest),this.listenTo(this,"ajax",this.ajaxKumbia),this.listenTo(this,"show:modal",this.renderModal),this.listenTo(this,"hide:modal",this.closeModal),this.listenTo(this,"down",this.downLoadFile),this.listenTo(this,"upload",this.uploadFile)},notify(t,e){this.showNoty(t,e.toString(),t==="error"?1e4:6e3)},alert(t,e){const{title:i="Notificación",message:s="Nota no hay respuesta de la solicitud",timer:a=8200}=e;this.showAlert(i,s,t,a)},showNoty(t,e,i){new Noty({text:e,layout:"topRight",theme:"relax",type:t,timeout:i}).show()},showAlert(t="",e="",i="",s){Swal.fire({title:t,html:e,icon:i,showConfirmButton:!1,confirmButtonText:"Continuar",timer:s})},startSubApplication(t,e,i={}){let s=[];return typeof e!="string"&&(_.isArray(e)===!0?_.each(e,a=>{s[a.name]=new a.inyectar}):_.isObject(e)===!0?s[e.name]=new e.inyectar:s.push(e)),this.mainRegion=new R({el:this.el,...i}),this.currentSubapp=new t({region:this.mainRegion,services:s,App:this}),this.currentSubapp},confirmaApp(t){const{message:e,callback:i,title:s="¿Confirmar?",icon:a="warning"}=t;Swal.fire({title:s,text:e,icon:a,showCancelButton:!0,confirmButtonColor:"#2dce89",cancelButtonColor:"#fc8c72",confirmButtonText:"SI, Continuar!"}).then(l=>{i(l.isConfirmed)})},syncroRequest(t){const{url:e,data:i={},callback:s,silent:a=!1}=t,l=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({type:"POST",dataType:"json",url:e,data:i,cache:!1,contentType:"application/x-www-form-urlencoded",processData:!0,timeout:52400,beforeSend:n=>{a==!1&&r.show(),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.length>0&&n.setRequestHeader("Authorization","Bearer "+l)},success:n=>(a==!1&&r.hide(),s(n)),error:n=>{const o=_.keys(n);return a==!1&&r.hide(),_.indexOf(o,"responseText")!==-1?(console.log(n.responseText),this.trigger("alert:error",{message:n.responseText})):(console.log(n),this.trigger("alert:error",{message:n})),s(!1)}})},renderModal(t={}){const{title:e,view:i,options:s=!1}=t,a=$("#modalComponent");this.Modal||(this.Modal=new bootstrap.Modal(document.getElementById("modalComponent"),{keyboard:!0,backdrop:"static"})),a.find("#mdl_set_title").text(e),a.find("#mdl_set_footer").css("display","none"),s&&a.find(".modal-dialog").addClass(s.bootstrapSize),a.find("#mdl_set_body").html(i.render().$el),this.Modal.show(),s&&(this.Modal.on("hidden.bs.modal",l=>i.remove()),a.find(".close").addClass("d-none"))},closeModal(t){this.Modal&&(this.Modal.hide(),this.Modal=null),t&&t.remove()},url(t="",e=void 0){return this.kumbiaURL((e??"")+"/"+t)},kumbiaURL:t=>(_.isUndefined(t)===!0&&(t=""),S.path+t),ajaxKumbia(t={}){const{url:e,data:i={},callback:s,silent:a=!1}=t,l=document.querySelector("[name='csrf-token']").getAttribute("content");$.ajax({type:"POST",data:i,url:this.kumbiaURL(e),dataType:"html",processData:!0,contentType:"application/x-www-form-urlencoded",cache:!1,beforeSend:n=>{a==!1&&r.show(),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.length>0&&n.setRequestHeader("Authorization","Bearer "+l)}}).done(n=>(a==!1&&r.hide(),s(n))).fail(n=>(a==!1&&r.hide(),this.trigger("alert:error",{message:n.responseText}),s(!1))).always(()=>{a==!1&&r.hide()})},downLoadFile(t){const{url:e,filename:i}=t,s=document.createElement("a");s.href=this.kumbiaURL(e+"/"+i),s.download=i,console.log(s),s.click()},uploadFile(t){const{url:e,data:i,callback:s,silent:a=!1}=t;let l;i instanceof FormData?l=i:(l=new FormData,l.append(i.name,i.file));const n=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({url:e,type:"POST",dataType:"json",data:l,cache:!1,contentType:!1,processData:!1,beforeSend:o=>{a==!1&&r.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.length>0&&o.setRequestHeader("Authorization","Bearer "+n)},success:o=>(a==!1&&r.hide(),s(o)),error:o=>{const m=_.keys(o);return console.log(o),a==!1&&r.hide(),_.indexOf(m,"responseText")!==-1?this.trigger("alert:error",{message:o.responseText}):this.trigger("alert:error",{message:o}),s(!1)}})}};(function(t){var e=0,i=[];t.fn.fileUpload=function(){return this.each(function(){const s=t(this),a=`fileUpload-${++e}`,l=`
                <label for="${a}" class="file-upload">
                    <div>
                        <b class="material-icons-outlined">Validar Documento</b>
                        <p>Arrastra y suelta archivo aquí</p>
                        <span>O</span>
                        <div>Click buscar archivos</div>
                    </div>
                    <input type="file" id="${a}" name=[] multiple hidden />
                </label>
            `;s.html(l).addClass("file-container");let n=null,o=null;function m(){n=t(`
                    <table>
                        <thead>
                            <tr>
                                <th></th>
                                <th style="width: 30%;">Nombre archivo</th>
                                <th style="width: 20%;">Tamaño</th>
                                <th>Tipo</th>
                                <th>Opciones</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                `),o=n.find("tbody"),s.append(n)}function w(d){n||m(),o.empty(),d.length>0&&(t.each(d,function(u,c){if(typeof u=="number"){i[u]=c;let h=c.name,k=(c.size/1024).toFixed(2)+" KB",v=c.type;o.append(`
                            <tr>
                                <td>${u+1}</td>
                                <td>${h}</td>
                                <td>${k}</td>
                                <td>${v}</td>
                                <td>
                                    <button type="button" class="btn btn-sm btn-primary validaBtn" data-cid='${u}'><i class="material-icons-outlined">Validar</i></button>
                                    <button type="button" class="btn btn-sm btn-danger deleteBtn"><i class="material-icons-outlined">Borrar</i></button>
                                </td>
                            </tr>
                        `)}}),o.find(".deleteBtn").click(function(){t(this).closest("tr").remove(),o.find("tr").length===0&&o.append('<tr><td colspan="6" class="no-file">No files selected!</td></tr>')}),o.find(".validaBtn").click(function(){const u=t(this).attr("data-cid"),c=new FormData;c.append("file",i[u]),f.trigger("upload",{url:f.url("validaFirma"),data:c,callback:h=>{h.success==!0?h.isValid==!0?f.trigger("alert:success",{message:h.msj}):f.trigger("alert:warning",{message:h.msj}):f.trigger("alert:error",{message:h.msj})}})}))}s.on({dragover:function(d){d.preventDefault(),s.toggleClass("dragover",d.type==="dragover")},drop:function(d){d.preventDefault(),s.removeClass("dragover"),w(d.originalEvent.dataTransfer.files)}}),s.find(`#${a}`).change(function(){w(this.files)})})}})(jQuery);$(()=>{f.initialize(),$("#fileUpload").fileUpload()});
//# sourceMappingURL=Firma.js.map
