var w=Object.defineProperty;var T=a=>{throw TypeError(a)};var R=(a,e,t)=>e in a?w(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var p=(a,e,t)=>R(a,typeof e!="symbol"?e+"":e,t);var c=(a,e,t)=>e.has(a)?T("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t);const k=()=>"Url error is undefined!",M=()=>Backbone.emulateHTTP=!0,S={create:"POST",update:"PUT",fetch:"GET",destroy:"DELETE"};Backbone.sync=(a,e,t)=>{const s=S[a],i=_.extend({type:s,dataType:"json",processData:!1},t);return i.url||(i.url=e.url||k()),!i.data&&e&&(a=="create"||a=="update")&&(i.contentType="application/json",i.data=JSON.stringify(e.toJSON())),!Backbone.emulateJSON&&!Backbone.emulateHTTP&&M(),Backbone.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.processData=!0,i.data=i.data?{model:i.data}:{},i.beforeSend=function(n){n.setRequestHeader("X-Requested-With","XMLHttpRequest")}),Backbone.emulateHTTP&&(s==="PUT"||s==="DELETE")&&(Backbone.emulateJSON&&(i.data._method=s),i.type="POST",i.beforeSend=n=>{n.setRequestHeader("X-HTTP-Method-Override",s)}),$.ajax(i)};const B={processing:"Procesando...",lengthMenu:"Mostrar _MENU_ resultados por pagínas",zeroRecords:"No se encontraron resultados",info:"Mostrando pagína _PAGE_ de _PAGES_.	Total de _TOTAL_ registros.",infoEmpty:"No records available",infoFiltered:"(filtered from _MAX_ total records)",emptyTable:"Ningún dato disponible en esta tabla",search:"Buscar",paginate:{next:"siguiente",previus:"anterior",first:"primero",last:"ultimo"},loadingRecords:"Cargando...",buttons:{copy:"Copiar",colvis:"Visibilidad",collection:"Colección",colvisRestore:"Restaurar visibilidad",copyKeys:"Presione ctrl o u2318 + C para copiar los datos de la tabla al portapapeles del sistema. <br /> <br /> Para cancelar, haga clic en este mensaje o presione escape.",copySuccess:{1:"Copiada 1 fila al portapapeles",_:"Copiadas %d fila al portapapeles"}}};var h,f,m;class u{constructor(e={}){c(this,h,null);c(this,f,null);c(this,m,null);_.extend(this,e),this.currentViews=new Array,this.el=e.el}show(e){this.closeView(this.currentView),this.currentView=e,this.openView(e)}html(e){this.$el&&this.$el.html(e)}append(e){this.currentViews.push(e),this.ensureEl(),e.render(),this.$el.append(e.el),e.onShow&&e.onShow()}closeView(e){e&&e.remove&&e.remove()}openView(e){this.ensureEl(),e.render(),this.$el.html(e.el),e.onShow&&e.onShow()}ensureEl(){this.$el||(this.$el=$(this.el))}remove(){this.currentViews.length>0&&this.currentViews.forEach(e=>{this.closeView(e)}),this.closeView(this.currentView)}}h=new WeakMap,f=new WeakMap,m=new WeakMap;const l=(()=>{let a,e,t,s;return{hide:(o=!1)=>{o&&e.remove(),a&&t.remove(),a=void 0},show:(o=!1,r)=>{o&&(e=document.createElement("div"),e.setAttribute("id","loading_msj"),$(e).html("<div class='loading_msj'><p class='text-warning'>Procesando datos de busqueda...</p></div>"),document.getElementById("app").appendChild(e)),a||(s=_.template($("#tmp_loader").html()),t=document.createElement("div"),t.setAttribute("class","loader"),t.setAttribute("id","loader"),$(t).append(s()),document.body.appendChild(t),t.setAttribute("style","display:block"),_.isObject(r)===!0&&r.addClass&&$(".loader").addClass(r.addClass)),a=!0}}})(),g=$("[name='csrf-token']"),C={path:g.attr("path"),app:g.attr("app")},d={Models:{},Collections:{},router:null,currentSubapp:null,Modal:null,layout:null,el:null,mainRegion:null,startApp(a,e="",t=""){this.el=t,this.el===""&&(this.el="#contentView"),this.initialize(),this.router=new a,Backbone.history.start()||this.router.navigate(e,{trigger:!0})},initialize(){_.extend(this,Backbone.Events),["error","warning","success","info"].forEach(e=>{this.listenTo(this,`noty:${e}`,t=>this.notify(e,t)),this.listenTo(this,`alert:${e}`,t=>this.alert(e,t))}),this.listenTo(this,"confirma",this.confirmaApp),this.listenTo(this,"syncro",this.syncroRequest),this.listenTo(this,"ajax",this.ajaxKumbia),this.listenTo(this,"show:modal",this.renderModal),this.listenTo(this,"hide:modal",this.closeModal),this.listenTo(this,"down",this.downLoadFile),this.listenTo(this,"upload",this.uploadFile)},notify(a,e){this.showNoty(a,e.toString(),a==="error"?1e4:6e3)},alert(a,e){const{title:t="Notificación",message:s="Nota no hay respuesta de la solicitud",timer:i=8200}=e;this.showAlert(t,s,a,i)},showNoty(a,e,t){new Noty({text:e,layout:"topRight",theme:"relax",type:a,timeout:t}).show()},showAlert(a="",e="",t="",s){Swal.fire({title:a,html:e,icon:t,showConfirmButton:!1,confirmButtonText:"Continuar",timer:s})},startSubApplication(a,e,t={}){let s=[];return typeof e!="string"&&(_.isArray(e)===!0?_.each(e,i=>{s[i.name]=new i.inyectar}):_.isObject(e)===!0?s[e.name]=new e.inyectar:s.push(e)),this.mainRegion=new u({el:this.el,...t}),this.currentSubapp=new a({region:this.mainRegion,services:s,App:this}),this.currentSubapp},confirmaApp(a){const{message:e,callback:t,title:s="¿Confirmar?",icon:i="warning"}=a;Swal.fire({title:s,text:e,icon:i,showCancelButton:!0,confirmButtonColor:"#2dce89",cancelButtonColor:"#fc8c72",confirmButtonText:"SI, Continuar!"}).then(n=>{t(n.isConfirmed)})},syncroRequest(a){const{url:e,data:t={},callback:s,silent:i=!1}=a,n=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({type:"POST",dataType:"json",url:e,data:t,cache:!1,contentType:"application/x-www-form-urlencoded",processData:!0,timeout:52400,beforeSend:o=>{i==!1&&l.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.length>0&&o.setRequestHeader("Authorization","Bearer "+n)},success:o=>(i==!1&&l.hide(),s(o)),error:o=>{const r=_.keys(o);return i==!1&&l.hide(),_.indexOf(r,"responseText")!==-1?(console.log(o.responseText),this.trigger("alert:error",{message:o.responseText})):(console.log(o),this.trigger("alert:error",{message:o})),s(!1)}})},renderModal(a={}){const{title:e,view:t,options:s=!1}=a,i=$("#modalComponent");this.Modal||(this.Modal=new bootstrap.Modal(document.getElementById("modalComponent"),{keyboard:!0,backdrop:"static"})),i.find("#mdl_set_title").text(e),i.find("#mdl_set_footer").css("display","none"),s&&i.find(".modal-dialog").addClass(s.bootstrapSize),i.find("#mdl_set_body").html(t.render().$el),this.Modal.show(),s&&(this.Modal.on("hidden.bs.modal",n=>t.remove()),i.find(".close").addClass("d-none"))},closeModal(a){this.Modal&&(this.Modal.hide(),this.Modal=null),a&&a.remove()},url(a="",e=void 0){return this.kumbiaURL((e??"")+"/"+a)},kumbiaURL:a=>(_.isUndefined(a)===!0&&(a=""),C.path+a),ajaxKumbia(a={}){const{url:e,data:t={},callback:s,silent:i=!1}=a,n=document.querySelector("[name='csrf-token']").getAttribute("content");$.ajax({type:"POST",data:t,url:this.kumbiaURL(e),dataType:"html",processData:!0,contentType:"application/x-www-form-urlencoded",cache:!1,beforeSend:o=>{i==!1&&l.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.length>0&&o.setRequestHeader("Authorization","Bearer "+n)}}).done(o=>(i==!1&&l.hide(),s(o))).fail(o=>(i==!1&&l.hide(),this.trigger("alert:error",{message:o.responseText}),s(!1))).always(()=>{i==!1&&l.hide()})},downLoadFile(a){const{url:e,filename:t}=a,s=document.createElement("a");s.href=this.kumbiaURL(e+"/"+t),s.download=t,console.log(s),s.click()},uploadFile(a){const{url:e,data:t,callback:s,silent:i=!1}=a;let n;t instanceof FormData?n=t:(n=new FormData,n.append(t.name,t.file));const o=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({url:e,type:"POST",dataType:"json",data:n,cache:!1,contentType:!1,processData:!1,beforeSend:r=>{i==!1&&l.show(),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.length>0&&r.setRequestHeader("Authorization","Bearer "+o)},success:r=>(i==!1&&l.hide(),s(r)),error:r=>{const y=_.keys(r);return console.log(r),i==!1&&l.hide(),_.indexOf(y,"responseText")!==-1?this.trigger("alert:error",{message:r.responseText}):this.trigger("alert:error",{message:r}),s(!1)}})}};class b extends Backbone.View{constructor(t={modelDOM:null,onRender:null}){super(t);p(this,"modelDOM",null);this.modelDOM=t.modelDOM||Backbone.Model,this.template=null,_.extend(this,t),this.onRender=_.isFunction(this.onRender)?this.onRender:null}render(){const t=this.serializeData();let s;return _.isFunction(this.template)?s=this.template(t):_.isString(this.template)&&(s=this.compileTemplate()(t)),this.$el.html(s),this.onRender&&this.onRender(this.$el),this}compileTemplate(){if(_.isString(this.template)===!0){const t=document.querySelector(this.template);return _.template(t.innerHTML)}return!1}serializeData(){let t=null;return this.modelDOM!==null?this.model instanceof this.modelDOM?t=this.model.toJSON():typeof this.model=="object"&&(t=this.model):typeof this.model=="object"&&(t=this.model),t||{}}getInput(t){return this.$el.find(`[name='${t}']`).val()}getInputById(t){return this.$el.find("#"+t).val()}setInput(t,s){return this.$el.find(`[name='${t}']`).val(s??"")}getInputByTag(t,s){return this.$el.find(`[${t}='${s}']`).val()}getCheck(t){return this.$el.find(`[name='${t}']:checked`).length}getInputFile(t){return this.$el.find("#"+t).files[0]}}class x extends b{constructor(e={}){super({...e,className:"row",onRender:()=>this.afterRender()}),this.$App=d,this.template=_.template(document.getElementById("templateConyuge").innerHTML)}afterRender(){console.log("afterRender")}}class A extends b{constructor(e={}){super({...e,className:"row",onRender:()=>this.afterRender()}),this.$App=d,this.template=_.template(document.getElementById("templateBeneficiario").innerHTML)}afterRender(){console.log("afterRender")}}$(()=>{d.initialize(),$(document).on("click","#bt_consulta_trabajadores",function(a){$("#form").validate({rules:{estado:{required:!0}}}),$("#form").valid()&&d.trigger("syncro",{url:d.url("consulta_trabajadores"),data:{estado:$("#estado").val()},callback:e=>{e&&e.success?($("#consulta").html(e.data),$("#dataTable").DataTable({paging:!0,ordering:!1,pageLength:10,pagingType:"numbers",info:!0,searching:!0,columnDefs:[{targets:0,width:"5%"},{targets:1,width:"10%"},{targets:2,width:"40%"},{targets:3,width:"15%"},{targets:4,width:"10%"}],order:[[0,"desc"]],language:B})):d.trigger("alert:error",{message:e.msg})}})}),$(document).on("click",'[data-event="ver_nucleo_familiar"]',function(a){a.preventDefault();const e=$(a.currentTarget).data("cedtra");if(!e)return;const t=new bootstrap.Modal(document.getElementById("modalConsultaNucleo"),{keyboard:!0,backdrop:"static"});d.trigger("syncro",{url:d.url("consulta_nucleo"),data:{cedtra:e},callback:s=>{if(!s||s.success==!1)d.trigger("alert:error",{message:s.msj});else{if(s.data.conyuges){const i=new x({model:{...s.data.params,conyuges:s.data.conyuges}});new u({el:"#render_conyuges"}).show(i)}else $("#render_conyuges").text("No hay datos de conyuge asociado con el trabajador");if(s.data.beneficiarios){const i=new A({model:{...s.data.params,beneficiarios:s.data.beneficiarios}});new u({el:"#render_beneficiarios"}).show(i)}else $("#render_beneficiarios").text("No hay datos de beneficiarios asociados con el trabajador");t.show()}}})}),$(document).on("change","#estado",function(a){$("#consulta").html(""),$(a.currentTarget).val()&&$("#bt_consulta_trabajadores").trigger("click")})});
//# sourceMappingURL=TrabajadoresEmpresa.js.map
