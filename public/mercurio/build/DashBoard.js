var y=t=>{throw TypeError(t)};var d=(t,e,a)=>e.has(t)?y("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a);var h,u,f;class b{constructor(e={}){d(this,h,null);d(this,u,null);d(this,f,null);_.extend(this,e),this.currentViews=new Array,this.el=e.el}show(e){this.closeView(this.currentView),this.currentView=e,this.openView(e)}html(e){this.$el&&this.$el.html(e)}append(e){this.currentViews.push(e),this.ensureEl(),e.render(),this.$el.append(e.el),e.onShow&&e.onShow()}closeView(e){e&&e.remove&&e.remove()}openView(e){this.ensureEl(),e.render(),this.$el.html(e.el),e.onShow&&e.onShow()}ensureEl(){this.$el||(this.$el=$(this.el))}remove(){this.currentViews.length>0&&this.currentViews.forEach(e=>{this.closeView(e)}),this.closeView(this.currentView)}}h=new WeakMap,u=new WeakMap,f=new WeakMap;const l=(()=>{let t,e,a,s;return{hide:(i=!1)=>{i&&e.remove(),t&&a.remove(),t=void 0},show:(i=!1,r)=>{i&&(e=document.createElement("div"),e.setAttribute("id","loading_msj"),$(e).html("<div class='loading_msj'><p class='text-warning'>Procesando datos de busqueda...</p></div>"),document.getElementById("app").appendChild(e)),t||(s=_.template($("#tmp_loader").html()),a=document.createElement("div"),a.setAttribute("class","loader"),a.setAttribute("id","loader"),$(a).append(s()),document.body.appendChild(a),a.setAttribute("style","display:block"),_.isObject(r)===!0&&r.addClass&&$(".loader").addClass(r.addClass)),t=!0}}})(),m=$("[name='csrf-token']"),w={path:m.attr("path"),app:m.attr("app")};class p{static display(e,a,s=8e3){new Noty({text:e,layout:"topRight",theme:"relax",type:a,timeout:s}).show()}}const c={Models:{},Collections:{},router:null,currentSubapp:null,Modal:null,layout:null,el:null,mainRegion:null,startApp(t,e="",a=""){this.el=a,this.el===""&&(this.el="#contentView"),this.initialize(),this.router=new t,Backbone.history.start()||this.router.navigate(e,{trigger:!0})},initialize(){_.extend(this,Backbone.Events),["error","warning","success","info"].forEach(e=>{this.listenTo(this,`noty:${e}`,a=>this.notify(e,a)),this.listenTo(this,`alert:${e}`,a=>this.alert(e,a))}),this.listenTo(this,"confirma",this.confirmaApp),this.listenTo(this,"syncro",this.syncroRequest),this.listenTo(this,"ajax",this.ajaxKumbia),this.listenTo(this,"show:modal",this.renderModal),this.listenTo(this,"hide:modal",this.closeModal),this.listenTo(this,"down",this.downLoadFile),this.listenTo(this,"upload",this.uploadFile)},notify(t,e){this.showNoty(t,e.toString(),t==="error"?1e4:6e3)},alert(t,e){const{title:a="Notificación",message:s="Nota no hay respuesta de la solicitud",timer:o=8200}=e;this.showAlert(a,s,t,o)},showNoty(t,e,a){new Noty({text:e,layout:"topRight",theme:"relax",type:t,timeout:a}).show()},showAlert(t="",e="",a="",s){Swal.fire({title:t,html:e,icon:a,showConfirmButton:!1,confirmButtonText:"Continuar",timer:s})},startSubApplication(t,e,a={}){let s=[];return typeof e!="string"&&(_.isArray(e)===!0?_.each(e,o=>{s[o.name]=new o.inyectar}):_.isObject(e)===!0?s[e.name]=new e.inyectar:s.push(e)),this.mainRegion=new b({el:this.el,...a}),this.currentSubapp=new t({region:this.mainRegion,services:s,App:this}),this.currentSubapp},confirmaApp(t){const{message:e,callback:a,title:s="¿Confirmar?",icon:o="warning"}=t;Swal.fire({title:s,text:e,icon:o,showCancelButton:!0,confirmButtonColor:"#2dce89",cancelButtonColor:"#fc8c72",confirmButtonText:"SI, Continuar!"}).then(n=>{a(n.isConfirmed)})},syncroRequest(t){const{url:e,data:a={},callback:s,silent:o=!1}=t,n=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({type:"POST",dataType:"json",url:e,data:a,cache:!1,contentType:"application/x-www-form-urlencoded",processData:!0,timeout:52400,beforeSend:i=>{o==!1&&l.show(),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.length>0&&i.setRequestHeader("Authorization","Bearer "+n)},success:i=>(o==!1&&l.hide(),s(i)),error:i=>{const r=_.keys(i);return o==!1&&l.hide(),_.indexOf(r,"responseText")!==-1?(console.log(i.responseText),this.trigger("alert:error",{message:i.responseText})):(console.log(i),this.trigger("alert:error",{message:i})),s(!1)}})},renderModal(t={}){const{title:e,view:a,options:s=!1}=t,o=$("#modalComponent");this.Modal||(this.Modal=new bootstrap.Modal(document.getElementById("modalComponent"),{keyboard:!0,backdrop:"static"})),o.find("#mdl_set_title").text(e),o.find("#mdl_set_footer").css("display","none"),s&&o.find(".modal-dialog").addClass(s.bootstrapSize),o.find("#mdl_set_body").html(a.render().$el),this.Modal.show(),s&&(this.Modal.on("hidden.bs.modal",n=>a.remove()),o.find(".close").addClass("d-none"))},closeModal(t){this.Modal&&(this.Modal.hide(),this.Modal=null),t&&t.remove()},url(t="",e=void 0){return this.kumbiaURL((e??"")+"/"+t)},kumbiaURL:t=>(_.isUndefined(t)===!0&&(t=""),w.path+t),ajaxKumbia(t={}){const{url:e,data:a={},callback:s,silent:o=!1}=t,n=document.querySelector("[name='csrf-token']").getAttribute("content");$.ajax({type:"POST",data:a,url:this.kumbiaURL(e),dataType:"html",processData:!0,contentType:"application/x-www-form-urlencoded",cache:!1,beforeSend:i=>{o==!1&&l.show(),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.length>0&&i.setRequestHeader("Authorization","Bearer "+n)}}).done(i=>(o==!1&&l.hide(),s(i))).fail(i=>(o==!1&&l.hide(),this.trigger("alert:error",{message:i.responseText}),s(!1))).always(()=>{o==!1&&l.hide()})},downLoadFile(t){const{url:e,filename:a}=t,s=document.createElement("a");s.href=this.kumbiaURL(e+"/"+a),s.download=a,console.log(s),s.click()},uploadFile(t){const{url:e,data:a,callback:s,silent:o=!1}=t;let n;a instanceof FormData?n=a:(n=new FormData,n.append(a.name,a.file));const i=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({url:e,type:"POST",dataType:"json",data:n,cache:!1,contentType:!1,processData:!1,beforeSend:r=>{o==!1&&l.show(),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.length>0&&r.setRequestHeader("Authorization","Bearer "+i)},success:r=>(o==!1&&l.hide(),s(r)),error:r=>{const g=_.keys(r);return console.log(r),o==!1&&l.hide(),_.indexOf(g,"responseText")!==-1?this.trigger("alert:error",{message:r.responseText}):this.trigger("alert:error",{message:r}),s(!1)}})}},x=()=>{$.ajax({type:"POST",url:c.url("traerAportesEmpresa"),data:{}}).done(t=>{if(t&&_.size(t.data)>0){const e=document.getElementById("chart-aportes").getContext("2d");new Chart(e,{type:"bar",data:{labels:t.labels,datasets:[{data:t.data,borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}else $("#render_chart_aportes").html("<div class='card'><div class='card-body'><h5>Informe de aportes</h5><p>La empresa no posee datos relacionados a los aportes realizados. </p></div></div>")}).fail((t,e)=>{p.display(t.statusText,"error")})},T=()=>{$.ajax({type:"POST",url:c.url("traerCategoriasEmpresa"),data:{}}).done(function(t){if(_.size(t.data)>0){var e=document.getElementById("chart-categorias").getContext("2d");new Chart(e,{type:"pie",data:{labels:t.labels,datasets:[{data:t.data,backgroundColor:["rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(255, 205, 86)"]}]}})}else $("#render_chart_categorias").html("<div class='card'><div class='card-body'><h5>Informe trabajadores por categorias</h5><p>La empresa no posee datos suficientes de trabajadores por categorias.</p></div></div>")}).fail(function(t,e){p.display(t.statusText,"error")})},S=()=>{$.ajax({type:"POST",url:c.url("traerGiroEmpresa"),data:{}}).done(function(t){const e=document.getElementById("chart-giro").getContext("2d");new Chart(e,{type:"bar",data:{labels:t.labels,datasets:[{data:t.data,borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}).fail(function(t,e){p.display(t.statusText,"error")})};$(()=>{c.initialize(),x(),T(),S()});
//# sourceMappingURL=DashBoard.js.map
