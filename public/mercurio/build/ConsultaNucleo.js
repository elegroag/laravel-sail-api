var b=Object.defineProperty;var R=s=>{throw TypeError(s)};var T=(s,t,e)=>t in s?b(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var h=(s,t,e)=>T(s,typeof t!="symbol"?t+"":t,e);var u=(s,t,e)=>t.has(s)?R("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e);var f,m,p;class g{constructor(t={}){u(this,f,null);u(this,m,null);u(this,p,null);_.extend(this,t),this.currentViews=new Array,this.el=t.el}show(t){this.closeView(this.currentView),this.currentView=t,this.openView(t)}html(t){this.$el&&this.$el.html(t)}append(t){this.currentViews.push(t),this.ensureEl(),t.render(),this.$el.append(t.el),t.onShow&&t.onShow()}closeView(t){t&&t.remove&&t.remove()}openView(t){this.ensureEl(),t.render(),this.$el.html(t.el),t.onShow&&t.onShow()}ensureEl(){this.$el||(this.$el=$(this.el))}remove(){this.currentViews.length>0&&this.currentViews.forEach(t=>{this.closeView(t)}),this.closeView(this.currentView)}}f=new WeakMap,m=new WeakMap,p=new WeakMap;const r=(()=>{let s,t,e,i;return{hide:(o=!1)=>{o&&t.remove(),s&&e.remove(),s=void 0},show:(o=!1,l)=>{o&&(t=document.createElement("div"),t.setAttribute("id","loading_msj"),$(t).html("<div class='loading_msj'><p class='text-warning'>Procesando datos de busqueda...</p></div>"),document.getElementById("app").appendChild(t)),s||(i=_.template($("#tmp_loader").html()),e=document.createElement("div"),e.setAttribute("class","loader"),e.setAttribute("id","loader"),$(e).append(i()),document.body.appendChild(e),e.setAttribute("style","display:block"),_.isObject(l)===!0&&l.addClass&&$(".loader").addClass(l.addClass)),s=!0}}})(),y=$("[name='csrf-token']"),k={path:y.attr("path"),app:y.attr("app")},d={Models:{},Collections:{},router:null,currentSubapp:null,Modal:null,layout:null,el:null,mainRegion:null,startApp(s,t="",e=""){this.el=e,this.el===""&&(this.el="#contentView"),this.initialize(),this.router=new s,Backbone.history.start()||this.router.navigate(t,{trigger:!0})},initialize(){_.extend(this,Backbone.Events),["error","warning","success","info"].forEach(t=>{this.listenTo(this,`noty:${t}`,e=>this.notify(t,e)),this.listenTo(this,`alert:${t}`,e=>this.alert(t,e))}),this.listenTo(this,"confirma",this.confirmaApp),this.listenTo(this,"syncro",this.syncroRequest),this.listenTo(this,"ajax",this.ajaxKumbia),this.listenTo(this,"show:modal",this.renderModal),this.listenTo(this,"hide:modal",this.closeModal),this.listenTo(this,"down",this.downLoadFile),this.listenTo(this,"upload",this.uploadFile)},notify(s,t){this.showNoty(s,t.toString(),s==="error"?1e4:6e3)},alert(s,t){const{title:e="Notificación",message:i="Nota no hay respuesta de la solicitud",timer:n=8200}=t;this.showAlert(e,i,s,n)},showNoty(s,t,e){new Noty({text:t,layout:"topRight",theme:"relax",type:s,timeout:e}).show()},showAlert(s="",t="",e="",i){Swal.fire({title:s,html:t,icon:e,showConfirmButton:!1,confirmButtonText:"Continuar",timer:i})},startSubApplication(s,t,e={}){let i=[];return typeof t!="string"&&(_.isArray(t)===!0?_.each(t,n=>{i[n.name]=new n.inyectar}):_.isObject(t)===!0?i[t.name]=new t.inyectar:i.push(t)),this.mainRegion=new g({el:this.el,...e}),this.currentSubapp=new s({region:this.mainRegion,services:i,App:this}),this.currentSubapp},confirmaApp(s){const{message:t,callback:e,title:i="¿Confirmar?",icon:n="warning"}=s;Swal.fire({title:i,text:t,icon:n,showCancelButton:!0,confirmButtonColor:"#2dce89",cancelButtonColor:"#fc8c72",confirmButtonText:"SI, Continuar!"}).then(a=>{e(a.isConfirmed)})},syncroRequest(s){const{url:t,data:e={},callback:i,silent:n=!1}=s,a=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({type:"POST",dataType:"json",url:t,data:e,cache:!1,contentType:"application/x-www-form-urlencoded",processData:!0,timeout:52400,beforeSend:o=>{n==!1&&r.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.length>0&&o.setRequestHeader("Authorization","Bearer "+a)},success:o=>(n==!1&&r.hide(),i(o)),error:o=>{const l=_.keys(o);return n==!1&&r.hide(),_.indexOf(l,"responseText")!==-1?(console.log(o.responseText),this.trigger("alert:error",{message:o.responseText})):(console.log(o),this.trigger("alert:error",{message:o})),i(!1)}})},renderModal(s={}){const{title:t,view:e,options:i=!1}=s,n=$("#modalComponent");this.Modal||(this.Modal=new bootstrap.Modal(document.getElementById("modalComponent"),{keyboard:!0,backdrop:"static"})),n.find("#mdl_set_title").text(t),n.find("#mdl_set_footer").css("display","none"),i&&n.find(".modal-dialog").addClass(i.bootstrapSize),n.find("#mdl_set_body").html(e.render().$el),this.Modal.show(),i&&(this.Modal.on("hidden.bs.modal",a=>e.remove()),n.find(".close").addClass("d-none"))},closeModal(s){this.Modal&&(this.Modal.hide(),this.Modal=null),s&&s.remove()},url(s="",t=void 0){return this.kumbiaURL((t??"")+"/"+s)},kumbiaURL:s=>(_.isUndefined(s)===!0&&(s=""),k.path+s),ajaxKumbia(s={}){const{url:t,data:e={},callback:i,silent:n=!1}=s,a=document.querySelector("[name='csrf-token']").getAttribute("content");$.ajax({type:"POST",data:e,url:this.kumbiaURL(t),dataType:"html",processData:!0,contentType:"application/x-www-form-urlencoded",cache:!1,beforeSend:o=>{n==!1&&r.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.length>0&&o.setRequestHeader("Authorization","Bearer "+a)}}).done(o=>(n==!1&&r.hide(),i(o))).fail(o=>(n==!1&&r.hide(),this.trigger("alert:error",{message:o.responseText}),i(!1))).always(()=>{n==!1&&r.hide()})},downLoadFile(s){const{url:t,filename:e}=s,i=document.createElement("a");i.href=this.kumbiaURL(t+"/"+e),i.download=e,console.log(i),i.click()},uploadFile(s){const{url:t,data:e,callback:i,silent:n=!1}=s;let a;e instanceof FormData?a=e:(a=new FormData,a.append(e.name,e.file));const o=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({url:t,type:"POST",dataType:"json",data:a,cache:!1,contentType:!1,processData:!1,beforeSend:l=>{n==!1&&r.show(),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.length>0&&l.setRequestHeader("Authorization","Bearer "+o)},success:l=>(n==!1&&r.hide(),i(l)),error:l=>{const w=_.keys(l);return console.log(l),n==!1&&r.hide(),_.indexOf(w,"responseText")!==-1?this.trigger("alert:error",{message:l.responseText}):this.trigger("alert:error",{message:l}),i(!1)}})}};class c extends Backbone.View{constructor(e={modelDOM:null,onRender:null}){super(e);h(this,"modelDOM",null);this.modelDOM=e.modelDOM||Backbone.Model,this.template=null,_.extend(this,e),this.onRender=_.isFunction(this.onRender)?this.onRender:null}render(){const e=this.serializeData();let i;return _.isFunction(this.template)?i=this.template(e):_.isString(this.template)&&(i=this.compileTemplate()(e)),this.$el.html(i),this.onRender&&this.onRender(this.$el),this}compileTemplate(){if(_.isString(this.template)===!0){const e=document.querySelector(this.template);return _.template(e.innerHTML)}return!1}serializeData(){let e=null;return this.modelDOM!==null?this.model instanceof this.modelDOM?e=this.model.toJSON():typeof this.model=="object"&&(e=this.model):typeof this.model=="object"&&(e=this.model),e||{}}getInput(e){return this.$el.find(`[name='${e}']`).val()}getInputById(e){return this.$el.find("#"+e).val()}setInput(e,i){return this.$el.find(`[name='${e}']`).val(i??"")}getInputByTag(e,i){return this.$el.find(`[${e}='${i}']`).val()}getCheck(e){return this.$el.find(`[name='${e}']:checked`).length}getInputFile(e){return this.$el.find("#"+e).files[0]}}class x extends c{constructor(e={}){super(e);h(this,"tagRegions",{});h(this,"regionsLayout",{});_.extend(this,e)}render(){this.closeRegions();const e=c.prototype.render.call(this);return this.configureRegions(),e}configureRegions(){const e=this.tagRegions||{};this.regionsLayout||(this.regionsLayout={}),_.each(e,(i,n)=>{let a=this.$(i);this.regionsLayout[n]=new g({el:a})})}getRegion(e){return this.regionsLayout?this.regionsLayout[e]:!1}remove(e={}){this.stopListening(),this.closeRegions(),c.prototype.remove.call(this,e)}closeRegions(){if(!this.regionsLayout)return!1;_.each(this.regionsLayout,e=>{e&&e.remove&&e.remove()})}}class M extends c{constructor(t={}){super({...t,className:"row",onRender:()=>this.afterRender()}),this.$App=d,this.template=_.template(document.getElementById("templateTrabajador").innerHTML)}afterRender(){console.log("afterRender")}}class C extends c{constructor(t={}){super({...t,className:"row",onRender:()=>this.afterRender()}),this.$App=d,this.template=_.template(document.getElementById("templateConyuge").innerHTML)}afterRender(){console.log("afterRender")}}class S extends c{constructor(t={}){super({...t,className:"row",onRender:()=>this.afterRender()}),this.$App=d,this.template=_.template(document.getElementById("templateBeneficiario").innerHTML)}afterRender(){console.log("afterRender")}}class B extends x{constructor(t={}){super({...t,template:"#tmp_layout",className:"tab-content",tagRegions:{trabajador:"#tabsTrabajador",conyuges:"#tabsConyuge",beneficiarios:"#tabsBeneficiario"}})}}$(()=>{d.initialize();const s=new B;new g({el:"#myTabContent"}).show(s),d.trigger("syncro",{url:d.url("consulta_nucleo"),data:{},callback:e=>{if(e&&e.success===!0){const i=new M({model:{...e.data.params,...e.data.trabajador}});s.getRegion("trabajador").show(i);const n=new C({model:{...e.data.params,conyuges:e.data.conyuges}});s.getRegion("conyuges").show(n);const a=new S({model:{...e.data.params,beneficiarios:e.data.beneficiarios}});s.getRegion("beneficiarios").show(a)}else d.trigger("alert:error",{message:e.msj})},silent:!1})});
//# sourceMappingURL=ConsultaNucleo.js.map
