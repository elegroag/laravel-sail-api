var y=Object.defineProperty;var R=t=>{throw TypeError(t)};var k=(t,e,a)=>e in t?y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var f=(t,e,a)=>k(t,typeof e!="symbol"?e+"":e,a);var c=(t,e,a)=>e.has(t)?R("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a);var h,p,m;class u{constructor(e={}){c(this,h,null);c(this,p,null);c(this,m,null);_.extend(this,e),this.currentViews=new Array,this.el=e.el}show(e){this.closeView(this.currentView),this.currentView=e,this.openView(e)}html(e){this.$el&&this.$el.html(e)}append(e){this.currentViews.push(e),this.ensureEl(),e.render(),this.$el.append(e.el),e.onShow&&e.onShow()}closeView(e){e&&e.remove&&e.remove()}openView(e){this.ensureEl(),e.render(),this.$el.html(e.el),e.onShow&&e.onShow()}ensureEl(){this.$el||(this.$el=$(this.el))}remove(){this.currentViews.length>0&&this.currentViews.forEach(e=>{this.closeView(e)}),this.closeView(this.currentView)}}h=new WeakMap,p=new WeakMap,m=new WeakMap;const l=(()=>{let t,e,a,i;return{hide:(r=!1)=>{r&&e.remove(),t&&a.remove(),t=void 0},show:(r=!1,s)=>{r&&(e=document.createElement("div"),e.setAttribute("id","loading_msj"),$(e).html("<div class='loading_msj'><p class='text-warning'>Procesando datos de busqueda...</p></div>"),document.getElementById("app").appendChild(e)),t||(i=_.template($("#tmp_loader").html()),a=document.createElement("div"),a.setAttribute("class","loader"),a.setAttribute("id","loader"),$(a).append(i()),document.body.appendChild(a),a.setAttribute("style","display:block"),_.isObject(s)===!0&&s.addClass&&$(".loader").addClass(s.addClass)),t=!0}}})(),b=$("[name='csrf-token']"),S={path:b.attr("path"),app:b.attr("app")},d={Models:{},Collections:{},router:null,currentSubapp:null,Modal:null,layout:null,el:null,mainRegion:null,startApp(t,e="",a=""){this.el=a,this.el===""&&(this.el="#contentView"),this.initialize(),this.router=new t,Backbone.history.start()||this.router.navigate(e,{trigger:!0})},initialize(){_.extend(this,Backbone.Events),["error","warning","success","info"].forEach(e=>{this.listenTo(this,`noty:${e}`,a=>this.notify(e,a)),this.listenTo(this,`alert:${e}`,a=>this.alert(e,a))}),this.listenTo(this,"confirma",this.confirmaApp),this.listenTo(this,"syncro",this.syncroRequest),this.listenTo(this,"ajax",this.ajaxKumbia),this.listenTo(this,"show:modal",this.renderModal),this.listenTo(this,"hide:modal",this.closeModal),this.listenTo(this,"down",this.downLoadFile),this.listenTo(this,"upload",this.uploadFile)},notify(t,e){this.showNoty(t,e.toString(),t==="error"?1e4:6e3)},alert(t,e){const{title:a="Notificación",message:i="Nota no hay respuesta de la solicitud",timer:n=8200}=e;this.showAlert(a,i,t,n)},showNoty(t,e,a){new Noty({text:e,layout:"topRight",theme:"relax",type:t,timeout:a}).show()},showAlert(t="",e="",a="",i){Swal.fire({title:t,html:e,icon:a,showConfirmButton:!1,confirmButtonText:"Continuar",timer:i})},startSubApplication(t,e,a={}){let i=[];return typeof e!="string"&&(_.isArray(e)===!0?_.each(e,n=>{i[n.name]=new n.inyectar}):_.isObject(e)===!0?i[e.name]=new e.inyectar:i.push(e)),this.mainRegion=new u({el:this.el,...a}),this.currentSubapp=new t({region:this.mainRegion,services:i,App:this}),this.currentSubapp},confirmaApp(t){const{message:e,callback:a,title:i="¿Confirmar?",icon:n="warning"}=t;Swal.fire({title:i,text:e,icon:n,showCancelButton:!0,confirmButtonColor:"#2dce89",cancelButtonColor:"#fc8c72",confirmButtonText:"SI, Continuar!"}).then(o=>{a(o.isConfirmed)})},syncroRequest(t){const{url:e,data:a={},callback:i,silent:n=!1}=t,o=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({type:"POST",dataType:"json",url:e,data:a,cache:!1,contentType:"application/x-www-form-urlencoded",processData:!0,timeout:52400,beforeSend:r=>{n==!1&&l.show(),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.length>0&&r.setRequestHeader("Authorization","Bearer "+o)},success:r=>(n==!1&&l.hide(),i(r)),error:r=>{const s=_.keys(r);return n==!1&&l.hide(),_.indexOf(s,"responseText")!==-1?(console.log(r.responseText),this.trigger("alert:error",{message:r.responseText})):(console.log(r),this.trigger("alert:error",{message:r})),i(!1)}})},renderModal(t={}){const{title:e,view:a,options:i=!1}=t,n=$("#modalComponent");this.Modal||(this.Modal=new bootstrap.Modal(document.getElementById("modalComponent"),{keyboard:!0,backdrop:"static"})),n.find("#mdl_set_title").text(e),n.find("#mdl_set_footer").css("display","none"),i&&n.find(".modal-dialog").addClass(i.bootstrapSize),n.find("#mdl_set_body").html(a.render().$el),this.Modal.show(),i&&(this.Modal.on("hidden.bs.modal",o=>a.remove()),n.find(".close").addClass("d-none"))},closeModal(t){this.Modal&&(this.Modal.hide(),this.Modal=null),t&&t.remove()},url(t="",e=void 0){return this.kumbiaURL((e??"")+"/"+t)},kumbiaURL:t=>(_.isUndefined(t)===!0&&(t=""),S.path+t),ajaxKumbia(t={}){const{url:e,data:a={},callback:i,silent:n=!1}=t,o=document.querySelector("[name='csrf-token']").getAttribute("content");$.ajax({type:"POST",data:a,url:this.kumbiaURL(e),dataType:"html",processData:!0,contentType:"application/x-www-form-urlencoded",cache:!1,beforeSend:r=>{n==!1&&l.show(),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.length>0&&r.setRequestHeader("Authorization","Bearer "+o)}}).done(r=>(n==!1&&l.hide(),i(r))).fail(r=>(n==!1&&l.hide(),this.trigger("alert:error",{message:r.responseText}),i(!1))).always(()=>{n==!1&&l.hide()})},downLoadFile(t){const{url:e,filename:a}=t,i=document.createElement("a");i.href=this.kumbiaURL(e+"/"+a),i.download=a,console.log(i),i.click()},uploadFile(t){const{url:e,data:a,callback:i,silent:n=!1}=t;let o;a instanceof FormData?o=a:(o=new FormData,o.append(a.name,a.file));const r=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({url:e,type:"POST",dataType:"json",data:o,cache:!1,contentType:!1,processData:!1,beforeSend:s=>{n==!1&&l.show(),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.length>0&&s.setRequestHeader("Authorization","Bearer "+r)},success:s=>(n==!1&&l.hide(),i(s)),error:s=>{const T=_.keys(s);return console.log(s),n==!1&&l.hide(),_.indexOf(T,"responseText")!==-1?this.trigger("alert:error",{message:s.responseText}):this.trigger("alert:error",{message:s}),i(!1)}})}};class g extends Backbone.View{constructor(a={modelDOM:null,onRender:null}){super(a);f(this,"modelDOM",null);this.modelDOM=a.modelDOM||Backbone.Model,this.template=null,_.extend(this,a),this.onRender=_.isFunction(this.onRender)?this.onRender:null}render(){const a=this.serializeData();let i;return _.isFunction(this.template)?i=this.template(a):_.isString(this.template)&&(i=this.compileTemplate()(a)),this.$el.html(i),this.onRender&&this.onRender(this.$el),this}compileTemplate(){if(_.isString(this.template)===!0){const a=document.querySelector(this.template);return _.template(a.innerHTML)}return!1}serializeData(){let a=null;return this.modelDOM!==null?this.model instanceof this.modelDOM?a=this.model.toJSON():typeof this.model=="object"&&(a=this.model):typeof this.model=="object"&&(a=this.model),a||{}}getInput(a){return this.$el.find(`[name='${a}']`).val()}getInputById(a){return this.$el.find("#"+a).val()}setInput(a,i){return this.$el.find(`[name='${a}']`).val(i??"")}getInputByTag(a,i){return this.$el.find(`[${a}='${i}']`).val()}getCheck(a){return this.$el.find(`[name='${a}']:checked`).length}getInputFile(a){return this.$el.find("#"+a).files[0]}}const v=()=>"Url error is undefined!",M=()=>Backbone.emulateHTTP=!0,q={create:"POST",update:"PUT",fetch:"GET",destroy:"DELETE"};Backbone.sync=(t,e,a)=>{const i=q[t],n=_.extend({type:i,dataType:"json",processData:!1},a);return n.url||(n.url=e.url||v()),!n.data&&e&&(t=="create"||t=="update")&&(n.contentType="application/json",n.data=JSON.stringify(e.toJSON())),!Backbone.emulateJSON&&!Backbone.emulateHTTP&&M(),Backbone.emulateJSON&&(n.contentType="application/x-www-form-urlencoded",n.processData=!0,n.data=n.data?{model:n.data}:{},n.beforeSend=function(o){o.setRequestHeader("X-Requested-With","XMLHttpRequest")}),Backbone.emulateHTTP&&(i==="PUT"||i==="DELETE")&&(Backbone.emulateJSON&&(n.data._method=i),n.type="POST",n.beforeSend=o=>{o.setRequestHeader("X-HTTP-Method-Override",i)}),$.ajax(n)};const w={processing:"Procesando...",lengthMenu:"Mostrar _MENU_ resultados por pagínas",zeroRecords:"No se encontraron resultados",info:"Mostrando pagína _PAGE_ de _PAGES_.	Total de _TOTAL_ registros.",infoEmpty:"No records available",infoFiltered:"(filtered from _MAX_ total records)",emptyTable:"Ningún dato disponible en esta tabla",search:"Buscar",paginate:{next:"siguiente",previus:"anterior",first:"primero",last:"ultimo"},loadingRecords:"Cargando...",buttons:{copy:"Copiar",colvis:"Visibilidad",collection:"Colección",colvisRestore:"Restaurar visibilidad",copyKeys:"Presione ctrl o u2318 + C para copiar los datos de la tabla al portapapeles del sistema. <br /> <br /> Para cancelar, haga clic en este mensaje o presione escape.",copySuccess:{1:"Copiada 1 fila al portapapeles",_:"Copiadas %d fila al portapapeles"}}};class x extends g{constructor(e={}){super({...e,onRender:()=>this.afterRender()}),this.template=_.template(document.getElementById("templateConsulta").innerHTML)}afterRender(){this.model.cuotas.length!=0&&(this.tableView=this.$el.find("#dataTable").DataTable({paging:!0,ordering:!0,pageLength:10,info:!0,searching:!0,pagingType:"numbers",language:w}))}}class j extends g{constructor(e={}){super(e),this.template=_.template(document.getElementById("templateNoGiro").innerHTML)}}class C extends g{constructor(a={}){super({...a,onRender:()=>this.afterRender()});f(this,"tableView",null);this.template=_.template(document.getElementById("templatePlanillas").innerHTML)}afterRender(){this.model.planilla.length!=0&&(this.tableView=this.$el.find("#dataTable").DataTable({paging:!0,ordering:!0,pageLength:10,info:!0,searching:!0,pagingType:"numbers",language:w}))}}function E(){$.ajax({type:"POST",url:d.url("consulta_giro"),data:{perini:$("#perini").val(),perfin:$("#perfin").val()},beforeSend:function(){l.show()}}).done(function(t){if(l.hide(),t.success==!1)d.alert("error",{title:"Error",message:t.msj,timer:8200});else{const e=new x({model:{cuotas:t.data}});new u({el:"#consulta"}).show(e)}}).fail(function(t,e){d.alert("error",{title:"Error",message:e.error,timer:8200})})}function B(){$.ajax({type:"POST",url:d.url("consulta_no_giro"),data:{perini:$("#perini").val(),perfin:$("#perfin").val()},beforeSend:function(){l.show()}}).done(function(t){if(l.hide(),t.success==!1)d.alert("error",{title:"Error",message:t.msj,timer:8200});else{const e=new j({model:{motivos:t.data}});new u({el:"#consulta"}).show(e)}}).fail(function(t,e){d.alert("error",{title:"Error",message:e.error,timer:8200})})}function O(){$.ajax({type:"POST",url:d.url("consulta_planilla_trabajador"),data:{perini:$("#perini").val(),perfin:$("#perfin").val()}}).done(function(t){if(l.hide(),t.success==!1)d.alert("error",{title:"Error",message:t.msj,timer:8200});else{const e=new C({model:{planilla:t.data}});new u({el:"#consulta"}).show(e)}}).fail(function(t,e){alert("Request failed: "+e)})}function A(){validator=$("#form").validate({rules:{tipo:{required:!0}}}),$("#form").valid()&&$("#form").submit()}$(()=>{d.initialize(),$(document).on("click","#bt_consulta_giro",function(t){t.preventDefault(),$("#form").validate({rules:{perini:{required:!0,date:!1},perfin:{required:!0,date:!1}}}).valid()&&E()}),$(document).on("click","#bt_consulta_nogiro",function(t){t.preventDefault(),$("#form").validate({rules:{perini:{required:!0,date:!1},perfin:{required:!0,date:!1,greaterThan:["#perini","Periodo Inicial"]}}}).valid()&&B()}),$(document).on("click","#bt_consulta_planilla_trabajador",function(t){t.preventDefault(),$("#form").validate({rules:{perini:{required:!0,date:!1},perfin:{required:!0,date:!1,greaterThan:["#perini","Periodo Inicial"]}}}).valid()&&O()}),$(document).on("click","#bt_certificado_afiliacion",A),$("#bt_consulta_giro").trigger("click"),$("#bt_consulta_nogiro").trigger("click"),$("#bt_consulta_planilla_trabajador").trigger("click")});
//# sourceMappingURL=ConsultasTrabajador.js.map
