var g=t=>{throw TypeError(t)};var d=(t,e,a)=>e.has(t)?g("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a);const b=()=>"Url error is undefined!",y=()=>Backbone.emulateHTTP=!0,w={create:"POST",update:"PUT",fetch:"GET",destroy:"DELETE"};Backbone.sync=(t,e,a)=>{const i=w[t],s=_.extend({type:i,dataType:"json",processData:!1},a);return s.url||(s.url=e.url||b()),!s.data&&e&&(t=="create"||t=="update")&&(s.contentType="application/json",s.data=JSON.stringify(e.toJSON())),!Backbone.emulateJSON&&!Backbone.emulateHTTP&&y(),Backbone.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.processData=!0,s.data=s.data?{model:s.data}:{},s.beforeSend=function(r){r.setRequestHeader("X-Requested-With","XMLHttpRequest")}),Backbone.emulateHTTP&&(i==="PUT"||i==="DELETE")&&(Backbone.emulateJSON&&(s.data._method=i),s.type="POST",s.beforeSend=r=>{r.setRequestHeader("X-HTTP-Method-Override",i)}),$.ajax(s)};const T={processing:"Procesando...",lengthMenu:"Mostrar _MENU_ resultados por pagínas",zeroRecords:"No se encontraron resultados",info:"Mostrando pagína _PAGE_ de _PAGES_.	Total de _TOTAL_ registros.",infoEmpty:"No records available",infoFiltered:"(filtered from _MAX_ total records)",emptyTable:"Ningún dato disponible en esta tabla",search:"Buscar",paginate:{next:"siguiente",previus:"anterior",first:"primero",last:"ultimo"},loadingRecords:"Cargando...",buttons:{copy:"Copiar",colvis:"Visibilidad",collection:"Colección",colvisRestore:"Restaurar visibilidad",copyKeys:"Presione ctrl o u2318 + C para copiar los datos de la tabla al portapapeles del sistema. <br /> <br /> Para cancelar, haga clic en este mensaje o presione escape.",copySuccess:{1:"Copiada 1 fila al portapapeles",_:"Copiadas %d fila al portapapeles"}}};var u,h,f;class k{constructor(e={}){d(this,u,null);d(this,h,null);d(this,f,null);_.extend(this,e),this.currentViews=new Array,this.el=e.el}show(e){this.closeView(this.currentView),this.currentView=e,this.openView(e)}html(e){this.$el&&this.$el.html(e)}append(e){this.currentViews.push(e),this.ensureEl(),e.render(),this.$el.append(e.el),e.onShow&&e.onShow()}closeView(e){e&&e.remove&&e.remove()}openView(e){this.ensureEl(),e.render(),this.$el.html(e.el),e.onShow&&e.onShow()}ensureEl(){this.$el||(this.$el=$(this.el))}remove(){this.currentViews.length>0&&this.currentViews.forEach(e=>{this.closeView(e)}),this.closeView(this.currentView)}}u=new WeakMap,h=new WeakMap,f=new WeakMap;const l=(()=>{let t,e,a,i;return{hide:(o=!1)=>{o&&e.remove(),t&&a.remove(),t=void 0},show:(o=!1,n)=>{o&&(e=document.createElement("div"),e.setAttribute("id","loading_msj"),$(e).html("<div class='loading_msj'><p class='text-warning'>Procesando datos de busqueda...</p></div>"),document.getElementById("app").appendChild(e)),t||(i=_.template($("#tmp_loader").html()),a=document.createElement("div"),a.setAttribute("class","loader"),a.setAttribute("id","loader"),$(a).append(i()),document.body.appendChild(a),a.setAttribute("style","display:block"),_.isObject(n)===!0&&n.addClass&&$(".loader").addClass(n.addClass)),t=!0}}})(),p=$("[name='csrf-token']"),S={path:p.attr("path"),app:p.attr("app")},c={Models:{},Collections:{},router:null,currentSubapp:null,Modal:null,layout:null,el:null,mainRegion:null,startApp(t,e="",a=""){this.el=a,this.el===""&&(this.el="#contentView"),this.initialize(),this.router=new t,Backbone.history.start()||this.router.navigate(e,{trigger:!0})},initialize(){_.extend(this,Backbone.Events),["error","warning","success","info"].forEach(e=>{this.listenTo(this,`noty:${e}`,a=>this.notify(e,a)),this.listenTo(this,`alert:${e}`,a=>this.alert(e,a))}),this.listenTo(this,"confirma",this.confirmaApp),this.listenTo(this,"syncro",this.syncroRequest),this.listenTo(this,"ajax",this.ajaxKumbia),this.listenTo(this,"show:modal",this.renderModal),this.listenTo(this,"hide:modal",this.closeModal),this.listenTo(this,"down",this.downLoadFile),this.listenTo(this,"upload",this.uploadFile)},notify(t,e){this.showNoty(t,e.toString(),t==="error"?1e4:6e3)},alert(t,e){const{title:a="Notificación",message:i="Nota no hay respuesta de la solicitud",timer:s=8200}=e;this.showAlert(a,i,t,s)},showNoty(t,e,a){new Noty({text:e,layout:"topRight",theme:"relax",type:t,timeout:a}).show()},showAlert(t="",e="",a="",i){Swal.fire({title:t,html:e,icon:a,showConfirmButton:!1,confirmButtonText:"Continuar",timer:i})},startSubApplication(t,e,a={}){let i=[];return typeof e!="string"&&(_.isArray(e)===!0?_.each(e,s=>{i[s.name]=new s.inyectar}):_.isObject(e)===!0?i[e.name]=new e.inyectar:i.push(e)),this.mainRegion=new k({el:this.el,...a}),this.currentSubapp=new t({region:this.mainRegion,services:i,App:this}),this.currentSubapp},confirmaApp(t){const{message:e,callback:a,title:i="¿Confirmar?",icon:s="warning"}=t;Swal.fire({title:i,text:e,icon:s,showCancelButton:!0,confirmButtonColor:"#2dce89",cancelButtonColor:"#fc8c72",confirmButtonText:"SI, Continuar!"}).then(r=>{a(r.isConfirmed)})},syncroRequest(t){const{url:e,data:a={},callback:i,silent:s=!1}=t,r=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({type:"POST",dataType:"json",url:e,data:a,cache:!1,contentType:"application/x-www-form-urlencoded",processData:!0,timeout:52400,beforeSend:o=>{s==!1&&l.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.length>0&&o.setRequestHeader("Authorization","Bearer "+r)},success:o=>(s==!1&&l.hide(),i(o)),error:o=>{const n=_.keys(o);return s==!1&&l.hide(),_.indexOf(n,"responseText")!==-1?(console.log(o.responseText),this.trigger("alert:error",{message:o.responseText})):(console.log(o),this.trigger("alert:error",{message:o})),i(!1)}})},renderModal(t={}){const{title:e,view:a,options:i=!1}=t,s=$("#modalComponent");this.Modal||(this.Modal=new bootstrap.Modal(document.getElementById("modalComponent"),{keyboard:!0,backdrop:"static"})),s.find("#mdl_set_title").text(e),s.find("#mdl_set_footer").css("display","none"),i&&s.find(".modal-dialog").addClass(i.bootstrapSize),s.find("#mdl_set_body").html(a.render().$el),this.Modal.show(),i&&(this.Modal.on("hidden.bs.modal",r=>a.remove()),s.find(".close").addClass("d-none"))},closeModal(t){this.Modal&&(this.Modal.hide(),this.Modal=null),t&&t.remove()},url(t="",e=void 0){return this.kumbiaURL((e??"")+"/"+t)},kumbiaURL:t=>(_.isUndefined(t)===!0&&(t=""),S.path+t),ajaxKumbia(t={}){const{url:e,data:a={},callback:i,silent:s=!1}=t,r=document.querySelector("[name='csrf-token']").getAttribute("content");$.ajax({type:"POST",data:a,url:this.kumbiaURL(e),dataType:"html",processData:!0,contentType:"application/x-www-form-urlencoded",cache:!1,beforeSend:o=>{s==!1&&l.show(),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.length>0&&o.setRequestHeader("Authorization","Bearer "+r)}}).done(o=>(s==!1&&l.hide(),i(o))).fail(o=>(s==!1&&l.hide(),this.trigger("alert:error",{message:o.responseText}),i(!1))).always(()=>{s==!1&&l.hide()})},downLoadFile(t){const{url:e,filename:a}=t,i=document.createElement("a");i.href=this.kumbiaURL(e+"/"+a),i.download=a,console.log(i),i.click()},uploadFile(t){const{url:e,data:a,callback:i,silent:s=!1}=t;let r;a instanceof FormData?r=a:(r=new FormData,r.append(a.name,a.file));const o=document.querySelector("[name='csrf-token']").getAttribute("content");Backbone.ajax({url:e,type:"POST",dataType:"json",data:r,cache:!1,contentType:!1,processData:!1,beforeSend:n=>{s==!1&&l.show(),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.length>0&&n.setRequestHeader("Authorization","Bearer "+o)},success:n=>(s==!1&&l.hide(),i(n)),error:n=>{const m=_.keys(n);return console.log(n),s==!1&&l.hide(),_.indexOf(m,"responseText")!==-1?this.trigger("alert:error",{message:n.responseText}):this.trigger("alert:error",{message:n}),i(!1)}})}};$(()=>{c.initialize(),$(document).on("click","#bt_consulta_aportes",t=>{t.preventDefault(),$("#form").validate({rules:{perini:{required:!0},perfin:{required:!0,greaterThan:["#perini","Periodo Inicial"]}}}),$("#form").valid()&&c.trigger("syncro",{url:c.url("consulta_aportes"),data:{perini:$("#perini").val(),perfin:$("#perfin").val()},callback:(e={})=>{!e||e.success==!1?c.trigger("alert:error",{message:e.msg}):($("#consulta").html(e.data),$("#dataTable").DataTable({paging:!0,ordering:!0,pageLength:10,pagingType:"numbers",info:!0,searching:!0,columnDefs:[{targets:0,width:"5%"},{targets:1,width:"10%"},{targets:2,width:"20%"},{targets:3,width:"15%"},{targets:4,width:"10%"}],order:[[0,"desc"]],language:T}))}})})});
//# sourceMappingURL=AportesEmpresa.js.map
